<!DOCTYPE html>
<!-- saved from url=(0043)./18_forms.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <title>Forms and Form Fields :: Eloquent JavaScript</title>
  <link rel="stylesheet" href="./media/codemirror.css">
  <script src="./media/acorn_codemirror.js"></script>
  <link rel="stylesheet" href="./media/ejs.css">
  <script src="./media/sandbox.js"></script>
  <script src="./media/ejs.js"></script>
  <script>var chapNum = 18;var sandboxLoadFiles = ["code/promise.js"];</script>
</head>

<body><article>
<nav>
  <a href="./17_http.html" title="previous chapter">◀</a>
  <a href="./index.html" title="cover">◆</a>
  <a href="./19_paint.html" title="next chapter">▶</a>
</nav>

<h1><div class="chap_num">Глава 18</div>Форми и полета на форми</h1>
<blockquote>
<p><a class="p_ident" id="p_HT1/Oht2V3" href="./18_forms.html#p_HT1/Oht2V3"></a>Аз ще трябва този същи ден, на докторския празник,<br>
своите задължения за услугата, надлежно да платя.<br>
Само едно нещо! В интерес на застраховка, моля,<br>
дай ми ред или два поне.”</p>
 <footer>Mephistopheles, <cite>in Goethe's Faust</cite></footer>
</blockquote>
<p><a class="p_ident" id="p_7R2RnNlXWq" href="./18_forms.html#p_7R2RnNlXWq"></a>Формите бяха показани за кратко в <a href="./17_http.html#http_forms">предишната глава</a>, като начин за представяне на информация, предоставена от потребителя през HTTP. Те са били предназначени за предварителен JavaScript Web, като се предполага, че взаимодействието със сървъра винаги се случва, когато навигираме към новата страница.</p>
<p><a class="p_ident" id="p_j1nZNHqVd+" href="./18_forms.html#p_j1nZNHqVd+"></a>Но техните елементи са част от DOM, както и останалата част от страницата и елементите на DOM, които представляват полета на форми подкрепят редица свойства и събития, които не присъстват в други елементи. Това прави възможно да се инспектират и контролират такива полета за въвеждане с програми на JavaScript и правят неща , като например добавяне на функционалност към традиционната форма или като се използват такива формуляри и полета за градивни елементи в JavaScript приложения.</p>
<h2><a class="h_ident" id="h_6LaFJxI4rf" href="./18_forms.html#h_6LaFJxI4rf"></a>Полета  (fields)</h2>
<p><a class="p_ident" id="p_pfSLM800x5" href="./18_forms.html#p_pfSLM800x5"></a>Уеб формата се състои от произволен брой полета за въвеждане групирани във <code>&lt;form&gt;</code> таг. HTML позволява няколко различни стилове на полета, вариращи от прости  <em>on/off</em>  отметки (<em>checkbox</em>) до падащи менюта (<em>drop-down</em>) и полета за въвеждане (<em>input</em>) на текст. В тази книга няма да се опитваме да разгледаме обстойно всички видове полета, но ще започнем с един общ преглед.</p>
<p><a class="p_ident" id="p_BtwDLFMJGW" href="./18_forms.html#p_BtwDLFMJGW"></a>Много видове полета използват <code>&lt;input&gt;</code> таг. Този маркер използва <code>type</code> атрибут за определяне на стила на полето. Това са само някои често използвани видове <code>&lt;input&gt;</code> :</p>
<table>
<tbody><tr>
<td><code>text</code></td>
<td>Едноредово текстово поле</td>
</tr>
<tr>
<td><code>password</code></td>
<td>Същото като <code>text</code>, но скрива текста, който е написан </td>
</tr>
<tr>
<td><code>checkbox</code></td>
<td>on/off  прекъсвач</td>
</tr>
<tr>
<td><code>radio</code></td>
<td>Част от поле за множествен избор</td>
</tr>
<tr>
<td><code>file</code></td>
<td>Позволява на потребителя да избере файл от компютъра</td>
</tr>
</tbody></table>
<p><a class="p_ident" id="p_LZvIgLQRq6" href="./18_forms.html#p_LZvIgLQRq6"></a>Форма полетата не трябва непременно да са във <code>&lt;form&gt;</code>  таг. Можем да ги поставим навсякъде в една страница. Такива полета не могат да бъдат предоставени (само форма като цяло), но в отговор на въвеждане с JavaScript, ние често не искаме да представим нашите полета нормално, така или иначе. </p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_JdU7BGrO0R" href="./18_forms.html#c_JdU7BGrO0R"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"text"</span> <span class="cm-attribute">value</span>=<span class="cm-string">"abc"</span><span class="cm-tag cm-bracket">&gt;</span> (text)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"password"</span> <span class="cm-attribute">value</span>=<span class="cm-string">"abc"</span><span class="cm-tag cm-bracket">&gt;</span> (password)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"checkbox"</span> <span class="cm-attribute">checked</span><span class="cm-tag cm-bracket">&gt;</span> (checkbox)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"radio"</span> <span class="cm-attribute">value</span>=<span class="cm-string">"A"</span> <span class="cm-attribute">name</span>=<span class="cm-string">"choice"</span><span class="cm-tag cm-bracket">&gt;</span>
   <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"radio"</span> <span class="cm-attribute">value</span>=<span class="cm-string">"B"</span> <span class="cm-attribute">name</span>=<span class="cm-string">"choice"</span> <span class="cm-attribute">checked</span><span class="cm-tag cm-bracket">&gt;</span>
   <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"radio"</span> <span class="cm-attribute">value</span>=<span class="cm-string">"C"</span> <span class="cm-attribute">name</span>=<span class="cm-string">"choice"</span><span class="cm-tag cm-bracket">&gt;</span> (radio)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"file"</span><span class="cm-tag cm-bracket">&gt;</span> (file)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">p</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_F4A/ei02Wb" href="./18_forms.html#p_F4A/ei02Wb"></a>Интерфейса на JavaScript  за такива елементи се различава с типа на елемента. Ще разгледаме всеки един от тях по-късно в тази глава.</p>
<p><a class="p_ident" id="p_dU8xgBYYQy" href="./18_forms.html#p_dU8xgBYYQy"></a>Многоредовите  текстови полета имат собствен етикет <code>&lt;textarea&gt;</code>,  най-вече защото се използва атрибут за определяне на многоредова стойност за започване, което би било неудобно. <code>&lt;textarea&gt;</code> изисква затварящ таг <code>&lt;/textarea&gt;</code> и използва текста между тези два тага, вместо да използва <code>value</code> атрибут, като изходен текст.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_aAsPR9klWW" href="./18_forms.html#c_aAsPR9klWW"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">textarea</span><span class="cm-tag cm-bracket">&gt;</span>
one
two
three
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">textarea</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_df6Ss3FBHe" href="./18_forms.html#p_df6Ss3FBHe"></a>И накрая <code>&lt;select&gt;</code> тага се използва за създаване на поле, което позволява на потребителя да избере между няколко предварително дефинирани опции.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_RjEtWnu+1N" href="./18_forms.html#c_RjEtWnu+1N"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">select</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>Pancakes<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>Pudding<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>Ice cream<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">select</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_Po+2LjUu/R" href="./18_forms.html#p_Po+2LjUu/R"></a>Всеки път, когато стойността на формата на полето се промени, се създава ефект на <code>"change"</code> събитие.</p>
<h2><a class="h_ident" id="h_/n9VuL9o/U" href="./18_forms.html#h_/n9VuL9o/U"></a>Фокус</h2>
<p><a class="p_ident" id="p_sv9Kp9pqvi" href="./18_forms.html#p_sv9Kp9pqvi"></a>За разлика от повечето елементи в един HTML документ, полето на формата може да получи фокуса на клавиатурата. При кликване или активиране по някакъв друг начин, по който елемента става активен в момента, той е основният получател на въвеждането от клавиатурата.</p>
<p><a class="p_ident" id="p_sPi491t84y" href="./18_forms.html#p_sPi491t84y"></a>Ако даден документ има текстово поле, текста ще приключи само до там до където е областта на фокуса. Другите полета реагират по различен начин на събития с клавиатурата. Например <code>&lt;select&gt;</code> менюто се опитва да премине към вариант, който съдържа текста на потребителя и отговаря на клавишите със стрелките, като преместим селекцията на горе или на долу.</p>
<p><a class="p_ident" id="p_bTNSIbb+d4" href="./18_forms.html#p_bTNSIbb+d4"></a>Можем да контролираме фокуса от JavaScript с методите <code>focus</code> и <code>blur</code>. Първото движение на фокуса към DOM елемент е извикването му, а второто е премахване на фокуса. Стойността в <code>document.activeElement</code> съответства на момента на фокусиране на елемента.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_0/XL0FGtcl" href="./18_forms.html#c_0/XL0FGtcl"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"text"</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"input"</span>).<span class="cm-property">focus</span>();
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">document</span>.<span class="cm-property">activeElement</span>.<span class="cm-property">tagName</span>);
  <span class="cm-comment">// → INPUT</span>
  <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"input"</span>).<span class="cm-property">blur</span>();
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">document</span>.<span class="cm-property">activeElement</span>.<span class="cm-property">tagName</span>);
  <span class="cm-comment">// → BODY</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_5/Idt5wdrL" href="./18_forms.html#p_5/Idt5wdrL"></a>За някои страници потребителя очаква да взаимодейства с поле на формуляр веднага. JavaScript може да се използва за съсредоточаване в тази област, когато е зареден документа, но HTML също осигурява <code>autofocus</code> атрибут, който произвежда същия ефект, като позволява на браузъра да знае, какво се опитваме да постигнем. Това дава възможност на браузъра да забрани поведението, когато това е необходимо, като например, когато потребителя фокусира нещо друго.</p>
<pre data-language="text/html" class="snippet cm-s-default" data-focus="true"><a class="c_ident" id="c_iwjnAcBDbo" href="./18_forms.html#c_iwjnAcBDbo"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"text"</span> <span class="cm-attribute">autofocus</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_IgspvfRub5" href="./18_forms.html#p_IgspvfRub5"></a>Браузъра също така позволява на потребителя да мести фокуса през документа чрез натискане на клавиша Tab. Ние можем да влияем на реда по-който елементите получават фокус с атрибута <code>tabindex</code>. Следният пример на документ ще позволи на фокуса да скача от въвеждането на текст към бутона  OK, вместо да минава през съдействието на помощния линк.</p>
<pre data-language="text/html" class="snippet cm-s-default" data-focus="true"><a class="c_ident" id="c_17Gw7jWqVc" href="./18_forms.html#c_17Gw7jWqVc"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"text"</span> <span class="cm-attribute">tabindex</span>=<span class="cm-string">1</span><span class="cm-tag cm-bracket">&gt;</span> <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">a</span> <span class="cm-attribute">href</span>=<span class="cm-string">"."</span><span class="cm-tag cm-bracket">&gt;</span>(help)<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">a</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">onclick</span>=<span class="cm-string">"console.log('ok')"</span> <span class="cm-attribute">tabindex</span>=<span class="cm-string">2</span><span class="cm-tag cm-bracket">&gt;</span>OK<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_CSZoExUC/a" href="./18_forms.html#p_CSZoExUC/a"></a>По подразбиране повечето видове HTML елементи не могат да бъдат фокусирани. Но можем да добавим  <code>tabindex</code> атрибут на всеки елемент, което ще го направи фокусируем.</p>
<h2><a class="h_ident" id="h_l2z9T1FDym" href="./18_forms.html#h_l2z9T1FDym"></a>Забраняване  на  полета</h2>
<p><a class="p_ident" id="p_yO5FA2RLmN" href="./18_forms.html#p_yO5FA2RLmN"></a>Всички полета на формите могат да бъдат деактивирани чрез <code>disabled</code> атрибута, който също съществува, като свойство на елементите на DOM обекта.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_8I51RKfnyr" href="./18_forms.html#c_8I51RKfnyr"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span>I'm all right<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">disabled</span><span class="cm-tag cm-bracket">&gt;</span>I'm out<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_GR2MtLESGu" href="./18_forms.html#p_GR2MtLESGu"></a>Деактивираните полета не могат да бъдат фокусирани или променяни и за разлика от активните области, те обикновено изглеждат сиво избледнели.</p>
<p><a class="p_ident" id="p_xuHzLzjgZ1" href="./18_forms.html#p_xuHzLzjgZ1"></a>Когато една програма е в процес на разглеждане на някой бутон или друго управление, което може да изисква комуникация със сървъра и по този начин отнема известно време, е може би добра идея да се забрани контрола, докато приключи действието. По този начин, когато потребителя нетърпеливо щрака отново, елементите не отговарят на неговото действие.</p>
<h2><a class="h_ident" id="h_R8SZxHmDt0" href="./18_forms.html#h_R8SZxHmDt0"></a>Формата  като  цяло</h2>
<p><a class="p_ident" id="p_G8aitsjxoL" href="./18_forms.html#p_G8aitsjxoL"></a>Когато едно поле се съдържа във <code>&lt;form&gt;</code> елемент, неговия DOM елемент ще има свойство <code>form</code> свързващо обратно DOM елемента с формата. <code>&lt;form&gt;</code> елемента от своя страна има свойство наречено <code>elements</code>, което съдържа масив с колекция от полета вътре в него.</p>
<p><a class="p_ident" id="p_7Ds/EaFyX5" href="./18_forms.html#p_7Ds/EaFyX5"></a>В <code>name</code> атрибута на формуляра се определя начина, по който неговата стойност да бъде идентифицирана, когато се подава формата. Той може да се използва, като име на свойство за  достъп до свойствата на елементите на формата, които действат като масиво-подобен обект (достъпен с номера) и карта (достъпна с имена).</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_toJqXrg6vf" href="./18_forms.html#c_toJqXrg6vf"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">form</span> <span class="cm-attribute">action</span>=<span class="cm-string">"example/submit.html"</span><span class="cm-tag cm-bracket">&gt;</span>
  Name: <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"text"</span> <span class="cm-attribute">name</span>=<span class="cm-string">"name"</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span>
  Password: <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"password"</span> <span class="cm-attribute">name</span>=<span class="cm-string">"password"</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">type</span>=<span class="cm-string">"submit"</span><span class="cm-tag cm-bracket">&gt;</span>Log in<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">form</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">var</span> <span class="cm-variable">form</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"form"</span>);
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">form</span>.<span class="cm-property">elements</span>[<span class="cm-number">1</span>].<span class="cm-property">type</span>);
  <span class="cm-comment">// → password</span>
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">form</span>.<span class="cm-property">elements</span>.<span class="cm-property">password</span>.<span class="cm-property">type</span>);
  <span class="cm-comment">// → password</span>
  <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">form</span>.<span class="cm-property">elements</span>.<span class="cm-property">name</span>.<span class="cm-property">form</span> <span class="cm-operator">==</span> <span class="cm-variable">form</span>);
  <span class="cm-comment">// → true</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_DOQDGp4ZWr" href="./18_forms.html#p_DOQDGp4ZWr"></a>Бутона с <code>type</code> атрибут на <code>submit</code>, когато е натиснат предизвиква формата да бъде представена. Натискането на Enter, когато полето на формуляра е фокусирано има същия ефект.</p>
<p><a class="p_ident" id="p_MVbboPCoBM" href="./18_forms.html#p_MVbboPCoBM"></a>Подаването на формуляр обикновено означава, че браузърът навигира към страницата, посочена от <code>action</code> атрибута на формата или с помоща на <code>GET</code> или <code>POST</code> заявка. Но преди това да се случи, <code>"submit"</code> събитието е изстреляно. Това събитие може да се обработва от JavaScript и манипулатора може да предотврати поведението по подразбиране, като извикаме <code>preventDefault</code> върху обекта на събитието.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_PXLNjO6XsV" href="./18_forms.html#c_PXLNjO6XsV"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">form</span> <span class="cm-attribute">action</span>=<span class="cm-string">"example/submit.html"</span><span class="cm-tag cm-bracket">&gt;</span>
  Value: <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"text"</span> <span class="cm-attribute">name</span>=<span class="cm-string">"value"</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">type</span>=<span class="cm-string">"submit"</span><span class="cm-tag cm-bracket">&gt;</span>Save<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">form</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">var</span> <span class="cm-variable">form</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"form"</span>);
  <span class="cm-variable">form</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">"submit"</span>, <span class="cm-keyword">function</span>(<span class="cm-def">event</span>) {
    <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"Saving value"</span>, <span class="cm-variable">form</span>.<span class="cm-property">elements</span>.<span class="cm-property">value</span>.<span class="cm-property">value</span>);
    <span class="cm-variable-2">event</span>.<span class="cm-property">preventDefault</span>();
  });
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_s3PgVwicoH" href="./18_forms.html#p_s3PgVwicoH"></a>Прихващане на <code>"submit"</code> събития в JavaScript има различни цели. Можем да напишем код, който да провери  дали въведените стойности на потребителя имат смисъл и ако нямат веднага да показва съобщение за грешка, вместо да предоставя формуляра. Или можем да забраним по обичайния начин подаване на формуляра изцяло, както в предишния пример или ако има нашата програма обработка на входа, по възможност с помощта на <code>XMLHttpRequest</code>, да го изпратим на сървъра, без да презарежда страницата.</p>
<h2><a class="h_ident" id="h_+RaBROT23F" href="./18_forms.html#h_+RaBROT23F"></a>Текстови  полета</h2>
<p><a class="p_ident" id="p_yXEHtldoGS" href="./18_forms.html#p_yXEHtldoGS"></a>Полетата създаени от <code>&lt;input&gt;</code> тагове с <code>type = text</code> или <code>password</code> както и <code>textarea</code> таговете, споделят общ интерфейс. Техните DOM елементи имат <code>value</code> свойство, което притежава текущото им съдържание, като стойност на <em>string</em>. Променянето на това свойство с друг <em>string</em> променя съдържанието на полето.</p>
<p><a class="p_ident" id="p_L8Jf4YksDD" href="./18_forms.html#p_L8Jf4YksDD"></a>Свойствата <code>selectionStart</code> и <code>selectionEnd</code> на текстовите полета ни дават информация за курсора и селекцията в текста. Когато нищо не е избрано, тези две свойства притежават същия номер, който показва позицията на курсора. Например, 0 показва началото на текста, а 10 показва, че курсора е след 10-ия символ. Когато е избрана част от полето, двете свойства ще се различават, което ни дава началото и края на избрания текст. Подобно на <code>value</code> тези свойства могат да бъдат написани.</p>
<p><a class="p_ident" id="p_xbJja7lj1o" href="./18_forms.html#p_xbJja7lj1o"></a>Като пример си представете, че пишете статия за Khasekhemwy но имате някои проблеми с правописа на името му. Следният код вмъква в <code>&lt;textarea&gt;</code> тага манипулатор за събитие и когато натиснете F2 вмъква <em>string</em> “Khasekhemwy”за вас.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_NyuUIijlnq" href="./18_forms.html#c_NyuUIijlnq"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">textarea</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">textarea</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">var</span> <span class="cm-variable">textarea</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"textarea"</span>);
  <span class="cm-variable">textarea</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">"keydown"</span>, <span class="cm-keyword">function</span>(<span class="cm-def">event</span>) {
    <span class="cm-comment">// The key code for F2 happens to be 113</span>
    <span class="cm-keyword">if</span> (<span class="cm-variable-2">event</span>.<span class="cm-property">keyCode</span> <span class="cm-operator">==</span> <span class="cm-number">113</span>) {
      <span class="cm-variable">replaceSelection</span>(<span class="cm-variable">textarea</span>, <span class="cm-string">"Khasekhemwy"</span>);
      <span class="cm-variable-2">event</span>.<span class="cm-property">preventDefault</span>();
    }
  });
  <span class="cm-keyword">function</span> <span class="cm-variable">replaceSelection</span>(<span class="cm-def">field</span>, <span class="cm-def">word</span>) {
    <span class="cm-keyword">var</span> <span class="cm-def">from</span> <span class="cm-operator">=</span> <span class="cm-variable-2">field</span>.<span class="cm-property">selectionStart</span>, <span class="cm-def">to</span> <span class="cm-operator">=</span> <span class="cm-variable-2">field</span>.<span class="cm-property">selectionEnd</span>;
    <span class="cm-variable-2">field</span>.<span class="cm-property">value</span> <span class="cm-operator">=</span> <span class="cm-variable-2">field</span>.<span class="cm-property">value</span>.<span class="cm-property">slice</span>(<span class="cm-number">0</span>, <span class="cm-variable-2">from</span>) <span class="cm-operator">+</span> <span class="cm-variable-2">word</span> <span class="cm-operator">+</span>
                  <span class="cm-variable-2">field</span>.<span class="cm-property">value</span>.<span class="cm-property">slice</span>(<span class="cm-variable-2">to</span>);
    <span class="cm-comment">// Put the cursor after the word</span>
    <span class="cm-variable-2">field</span>.<span class="cm-property">selectionStart</span> <span class="cm-operator">=</span> <span class="cm-variable-2">field</span>.<span class="cm-property">selectionEnd</span> <span class="cm-operator">=</span>
      <span class="cm-variable-2">from</span> <span class="cm-operator">+</span> <span class="cm-variable-2">word</span>.<span class="cm-property">length</span>;
  }
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_Gwpy8qmRbK" href="./18_forms.html#p_Gwpy8qmRbK"></a>Функцията <code>replaceSelection</code> замества избраната в момента част от съдържанието на текстовото поле с дадената дума и след това премества курсора след тази дума, така че потребителя да може да продължи да пише.</p>
<p><a class="p_ident" id="p_n9HEUfXSP7" href="./18_forms.html#p_n9HEUfXSP7"></a><code>"change"</code> събитието за текстовото поле не се активира всеки път, когато нещо е написано. Вместо това то се активира, когато областта губи фокус, след като съдържанието и е променено. За да реагира незабавно на промени в текстовото поле, можем да регистрираме манипулатор за събитие на <code>"input"</code> вместо това, който реагира всеки път, когато потребителя пише символ, изтрива текст или по друг начин манипулира съдържанието на полето.</p>
<p><a class="p_ident" id="p_EA90jWvW4M" href="./18_forms.html#p_EA90jWvW4M"></a>Следващият пример показва текстово поле и брояч показващ текущата дължина на въведения текст.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_A5KP6SC+kD" href="./18_forms.html#c_A5KP6SC+kD"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"text"</span><span class="cm-tag cm-bracket">&gt;</span> length: <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">id</span>=<span class="cm-string">"length"</span><span class="cm-tag cm-bracket">&gt;</span>0<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">var</span> <span class="cm-variable">text</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"input"</span>);
  <span class="cm-keyword">var</span> <span class="cm-variable">output</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"#length"</span>);
  <span class="cm-variable">text</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">"input"</span>, <span class="cm-keyword">function</span>() {
    <span class="cm-variable">output</span>.<span class="cm-property">textContent</span> <span class="cm-operator">=</span> <span class="cm-variable">text</span>.<span class="cm-property">value</span>.<span class="cm-property">length</span>;
  });
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<h2><a class="h_ident" id="h_axUK+XNvTN" href="./18_forms.html#h_axUK+XNvTN"></a>Чек-боксове  и  радио  бутони</h2>
<p><a class="p_ident" id="p_DFZwKUx9E+" href="./18_forms.html#p_DFZwKUx9E+"></a>Полето на чек-бокса е прост бинарен превключвател. Стойността му може да бъде извлечена или променена чрез неговото <code>checked</code> свойство, което притежава Булева стойност.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_hJgh0RAc5v" href="./18_forms.html#c_hJgh0RAc5v"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"checkbox"</span> <span class="cm-attribute">id</span>=<span class="cm-string">"purple"</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">label</span> <span class="cm-attribute">for</span>=<span class="cm-string">"purple"</span><span class="cm-tag cm-bracket">&gt;</span>Make this page purple<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">label</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">var</span> <span class="cm-variable">checkbox</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"#purple"</span>);
  <span class="cm-variable">checkbox</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">"change"</span>, <span class="cm-keyword">function</span>() {
    <span class="cm-variable">document</span>.<span class="cm-property">body</span>.<span class="cm-property">style</span>.<span class="cm-property">background</span> <span class="cm-operator">=</span>
      <span class="cm-variable">checkbox</span>.<span class="cm-property">checked</span> <span class="cm-operator">?</span> <span class="cm-string">"mediumpurple"</span> : <span class="cm-string">""</span>;
  });
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_AcH0aFeYIj" href="./18_forms.html#p_AcH0aFeYIj"></a>Тага <code>&lt;label&gt;</code> се използва за асоцииране на част от текст с поле за въвеждане. Неговия <code>for</code> атрибут трябва да се обърне към <code>id</code> на полето. Кликването върху етикета ще активира областа, в която се  фокусира или превключва стойността си, когато това е чек-бокс или радио бутон.</p>
<p><a class="p_ident" id="p_vNsiBxZlre" href="./18_forms.html#p_vNsiBxZlre"></a>Радио бутона е подобен на чек-бокса, но е свързан косвено с други радио бутони със същия <code>name</code> атрибут, така че само един от тях може да бъде активен по едно и също време.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_P3tSzP314m" href="./18_forms.html#c_P3tSzP314m"></a>Color:
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"radio"</span> <span class="cm-attribute">name</span>=<span class="cm-string">"color"</span> <span class="cm-attribute">value</span>=<span class="cm-string">"mediumpurple"</span><span class="cm-tag cm-bracket">&gt;</span> Purple
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"radio"</span> <span class="cm-attribute">name</span>=<span class="cm-string">"color"</span> <span class="cm-attribute">value</span>=<span class="cm-string">"lightgreen"</span><span class="cm-tag cm-bracket">&gt;</span> Green
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"radio"</span> <span class="cm-attribute">name</span>=<span class="cm-string">"color"</span> <span class="cm-attribute">value</span>=<span class="cm-string">"lightblue"</span><span class="cm-tag cm-bracket">&gt;</span> Blue
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">var</span> <span class="cm-variable">buttons</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">getElementsByName</span>(<span class="cm-string">"color"</span>);
  <span class="cm-keyword">function</span> <span class="cm-variable">setColor</span>(<span class="cm-def">event</span>) {
    <span class="cm-variable">document</span>.<span class="cm-property">body</span>.<span class="cm-property">style</span>.<span class="cm-property">background</span> <span class="cm-operator">=</span> <span class="cm-variable-2">event</span>.<span class="cm-property">target</span>.<span class="cm-property">value</span>;
  }
  <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-variable">i</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class="cm-variable">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable">buttons</span>.<span class="cm-property">length</span>; <span class="cm-variable">i</span><span class="cm-operator">++</span>)
    <span class="cm-variable">buttons</span>[<span class="cm-variable">i</span>].<span class="cm-property">addEventListener</span>(<span class="cm-string">"change"</span>, <span class="cm-variable">setColor</span>);
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_TLnCgOnKU5" href="./18_forms.html#p_TLnCgOnKU5"></a>Метода <code>document.getElementsByName</code> ни дава всички елементи с един и същ <code>name</code> атрибут. Примерът минава с цикъл през тези бутони (с редовен <code>for</code> цикъл, а не с <code>forEach</code>, защото връща колекция, а не реален масив) и регистрира обработка на събитие за всеки елемент. Не забравяйте, че обекта на събитието има <code>target</code> свойство, отнасящо се до елемента, който предизвиква събитието. Това често е полезно при манипулатори като тези, когато се извикват върху различни елементи и се нуждаят от начин за достигане на текущата цел.</p>
<h2><a class="h_ident" id="h_eaB6RprDK3" href="./18_forms.html#h_eaB6RprDK3"></a>Селектиране  на  полета</h2>
<p><a class="p_ident" id="p_C43QMBKrcK" href="./18_forms.html#p_C43QMBKrcK"></a>Изборът на  полета е концептуално подобен на радио бутоните - те позволяват на потребителя да избере от набор от опции. Но когато един радио бутон поставя оформлението на опциите под наш контрол, появата на тага <code>&lt;select&gt;</code> се определя от браузъра.</p>
<p><a class="p_ident" id="p_NtH8drqnHG" href="./18_forms.html#p_NtH8drqnHG"></a>Селектирането на полета също има вариант, който е по-близко до списък с чек-боксове, от колкото с радио бутони. Когато се даде <code>multiple</code> атрибут, <code>&lt;select&gt;</code> тага ще позволи на потребителя да избира произволен брой опции, а не само една опция.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_DU0yKS293E" href="./18_forms.html#c_DU0yKS293E"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">select</span> <span class="cm-attribute">multiple</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>Pancakes<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>Pudding<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>Ice cream<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">select</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_ZdHBLZYAi8" href="./18_forms.html#p_ZdHBLZYAi8"></a>В повечето браузъри това поле за избор се появява различно, като обикновено се представя, като <em>drop-down</em> контрол, който показва алтернативите едва, като го отворите.</p>
<p><a class="p_ident" id="p_Hyw0pVZgH2" href="./18_forms.html#p_Hyw0pVZgH2"></a>Атрибута <code>size</code> на <code>&lt;select&gt;</code> тага се използва за задаване на броя на опциите, които са видими по едно и също време, което ни дава контрол върху външния вид на падащото меню. Например, определянето на атрибута <code>size</code> с <code>"3"</code> ще направи видимо поле с три линии, независимо дали опцията <code>multiple</code> е включена или не.</p>
<p><a class="p_ident" id="p_6B1JfRLbxg" href="./18_forms.html#p_6B1JfRLbxg"></a>Всеки <code>&lt;option&gt;</code> таг има стойност. Тази стойност може да се определи с <code>value</code> атрибут, но ако той не е зададен, текста вътре в опцията се брои за такава стойност на опцията. Свойството <code>value</code> на елемента <code>&lt;select&gt;</code> отразява текущо избраната опция. За поле направено с <code>multiple</code>, това свойство не означава много, тъй като ще даде стойност на само една от опциите избрани в момента.</p>
<p><a class="p_ident" id="p_Aum9ltngdE" href="./18_forms.html#p_Aum9ltngdE"></a><code>&lt;option&gt;</code> таговете на полето <code>&lt;select&gt;</code> могат да бъдат достъпни, като масиво-подобен обект през полето на свойството на опциите. Всяка опция има свойство <code>selected</code>, което показва дали тази опция е избрана в момента. С това свойство може да се запише, избере или откаже опция.</p>
<p><a class="p_ident" id="p_IxfFgaCJNR" href="./18_forms.html#p_IxfFgaCJNR"></a>Следващият пример извлича избрани стойности от селектираното с <code>multiple</code> поле и ги използва за да композира бинарно число от отделни битове. Задръжте Ctrl (или Command на Mac) за да изберете няколко опции.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_71aTiF2Jay" href="./18_forms.html#c_71aTiF2Jay"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">select</span> <span class="cm-attribute">multiple</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span> <span class="cm-attribute">value</span>=<span class="cm-string">"1"</span><span class="cm-tag cm-bracket">&gt;</span>0001<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span> <span class="cm-attribute">value</span>=<span class="cm-string">"2"</span><span class="cm-tag cm-bracket">&gt;</span>0010<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span> <span class="cm-attribute">value</span>=<span class="cm-string">"4"</span><span class="cm-tag cm-bracket">&gt;</span>0100<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">option</span> <span class="cm-attribute">value</span>=<span class="cm-string">"8"</span><span class="cm-tag cm-bracket">&gt;</span>1000<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">option</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">select</span><span class="cm-tag cm-bracket">&gt;</span> = <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">span</span> <span class="cm-attribute">id</span>=<span class="cm-string">"output"</span><span class="cm-tag cm-bracket">&gt;</span>0<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">var</span> <span class="cm-variable">select</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"select"</span>);
  <span class="cm-keyword">var</span> <span class="cm-variable">output</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"#output"</span>);
  <span class="cm-variable">select</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">"change"</span>, <span class="cm-keyword">function</span>() {
    <span class="cm-keyword">var</span> <span class="cm-def">number</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>;
    <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">i</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class="cm-variable-2">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable">select</span>.<span class="cm-property">options</span>.<span class="cm-property">length</span>; <span class="cm-variable-2">i</span><span class="cm-operator">++</span>) {
      <span class="cm-keyword">var</span> <span class="cm-def">option</span> <span class="cm-operator">=</span> <span class="cm-variable">select</span>.<span class="cm-property">options</span>[<span class="cm-variable-2">i</span>];
      <span class="cm-keyword">if</span> (<span class="cm-variable-2">option</span>.<span class="cm-property">selected</span>)
        <span class="cm-variable-2">number</span> <span class="cm-operator">+=</span> <span class="cm-variable">Number</span>(<span class="cm-variable-2">option</span>.<span class="cm-property">value</span>);
    }
    <span class="cm-variable">output</span>.<span class="cm-property">textContent</span> <span class="cm-operator">=</span> <span class="cm-variable-2">number</span>;
  });
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<h2><a class="h_ident" id="h_tK84z183/8" href="./18_forms.html#h_tK84z183/8"></a>Файл  полета</h2>
<p><a class="p_ident" id="p_12DuX873Jk" href="./18_forms.html#p_12DuX873Jk"></a>Файл полетата  първоначално са били предназначени, като начин за качване на файлове от машината на браузъра чрез форма. В съвременните браузъри те също така предоставят начин за четене на такива файлове от програми на JavaScript. Полето действа, като портиер. Скрипта не може просто да започне да чете лични файлове от компютъра на потребителя, но ако потребителя избере файл в такова поле, браузърът интерпретира това действие, като знак, че скрипта може да прочете файла.</p>
<p><a class="p_ident" id="p_poF7nvM5XY" href="./18_forms.html#p_poF7nvM5XY"></a>Файл полето обикновено прилича на бутон маркиран с нещо, като “изберете файл” или “сърфирайте” с информацията за избрания файл до него.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_XxlcS1DiHf" href="./18_forms.html#c_XxlcS1DiHf"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"file"</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">var</span> <span class="cm-variable">input</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"input"</span>);
  <span class="cm-variable">input</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">"change"</span>, <span class="cm-keyword">function</span>() {
    <span class="cm-keyword">if</span> (<span class="cm-variable">input</span>.<span class="cm-property">files</span>.<span class="cm-property">length</span> <span class="cm-operator">&gt;</span> <span class="cm-number">0</span>) {
      <span class="cm-keyword">var</span> <span class="cm-def">file</span> <span class="cm-operator">=</span> <span class="cm-variable">input</span>.<span class="cm-property">files</span>[<span class="cm-number">0</span>];
      <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"You chose"</span>, <span class="cm-variable-2">file</span>.<span class="cm-property">name</span>);
      <span class="cm-keyword">if</span> (<span class="cm-variable-2">file</span>.<span class="cm-property">type</span>)
        <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"It has type"</span>, <span class="cm-variable-2">file</span>.<span class="cm-property">type</span>);
    }
  });
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_J8fD00m75/" href="./18_forms.html#p_J8fD00m75/"></a>Свойството <code>files</code> на елемента на файл полето е масиво-подобен обект (отново нереален масив), съдържащ файлове избрани в полето. То първоначално е празно. Причината, че не е просто едно файл свойство, е че файловите полета също подкрепят <code>multiple</code> атрибут, които дава възможност за избор на множество файлове едновременно.</p>
<p><a class="p_ident" id="p_VjLruEMwm5" href="./18_forms.html#p_VjLruEMwm5"></a>Обектите в свойството <code>files</code> имат свойства, като например <code>name</code> (името на файла), <code>size</code> (размер на файла в битове) и <code>type</code> (за типа носител на файла, като <code>text/plain</code> или <code>image/jpeg</code>).</p>
<p id="filereader"><a class="p_ident" id="p_ezd+X1Rw54" href="./18_forms.html#p_ezd+X1Rw54"></a>Какво не трябва да съдържа свойството, което съдържа съдържанието на файла. Това е получаване на малко повече достъп. Четене на файл от диск може да отнеме време и за това интерфейса трябва да бъде асинхронен за да се избегне замръзване на документа. Можем да мислим за <code>FileReader</code> конструктора, като подобен на <code>XMLHttpRequest</code>, но за файлове.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_eDdgcCTx3j" href="./18_forms.html#c_eDdgcCTx3j"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"file"</span> <span class="cm-attribute">multiple</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">var</span> <span class="cm-variable">input</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"input"</span>);
  <span class="cm-variable">input</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">"change"</span>, <span class="cm-keyword">function</span>() {
    <span class="cm-variable">Array</span>.<span class="cm-property">prototype</span>.<span class="cm-property">forEach</span>.<span class="cm-property">call</span>(<span class="cm-variable">input</span>.<span class="cm-property">files</span>, <span class="cm-keyword">function</span>(<span class="cm-def">file</span>) {
      <span class="cm-keyword">var</span> <span class="cm-def">reader</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">FileReader</span>();
      <span class="cm-variable-2">reader</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">"load"</span>, <span class="cm-keyword">function</span>() {
        <span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-string">"File"</span>, <span class="cm-variable-2">file</span>.<span class="cm-property">name</span>, <span class="cm-string">"starts with"</span>,
                    <span class="cm-variable-2">reader</span>.<span class="cm-property">result</span>.<span class="cm-property">slice</span>(<span class="cm-number">0</span>, <span class="cm-number">20</span>));
      });
      <span class="cm-variable-2">reader</span>.<span class="cm-property">readAsText</span>(<span class="cm-variable-2">file</span>);
    });
  });
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_ig0flob0QZ" href="./18_forms.html#p_ig0flob0QZ"></a>Четенето на файл се извършва чрез създаване на <code>FileReader</code> обект, регистрирайки <code>"load"</code> за обработка на събитие и извиквайки своя <code>readAsText</code> метод давайки му файла, който искаме да прочете. След приключване на зареждането, свойството <code>result</code> на <em>reader</em> съдържа съдържанието на файла.</p>
<p><a class="p_ident" id="p_mwjAqF7An3" href="./18_forms.html#p_mwjAqF7An3"></a>Примерът използва <code>Array.prototype.forEach</code> за обхождане на масива, тъй като нормален цикъл би бил неудобен за получаване на правилните <code>file</code> и <code>reader</code> обекти от манипулатора на събитието. Променливите ще бъдат споделени от всички повторения на цикъла.</p>
<p><a class="p_ident" id="p_f5Kaoq//VK" href="./18_forms.html#p_f5Kaoq//VK"></a><code>FileReader</code> също има ефект за <code>"error"</code> събитие, ако четенето на файла не успее по някаква причина. Самия обект за грешка ще попадне в свойството <code>error</code> на <em>reader</em>. Ако не искаме да си спомняме подробности от някоя несъвместимост с асинхронния интерфейс, можем да го увием в <code>Promise</code> (виж <a href="./17_http.html#promises">Глава 17</a>) по подобен начин:</p>
<pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_ZypgMPtwaf" href="./18_forms.html#c_ZypgMPtwaf"></a><span class="cm-keyword">function</span> <span class="cm-variable">readFile</span>(<span class="cm-def">file</span>) {
  <span class="cm-keyword">return</span> <span class="cm-keyword">new</span> <span class="cm-variable">Promise</span>(<span class="cm-keyword">function</span>(<span class="cm-def">succeed</span>, <span class="cm-def">fail</span>) {
    <span class="cm-keyword">var</span> <span class="cm-def">reader</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">FileReader</span>();
    <span class="cm-variable-2">reader</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">"load"</span>, <span class="cm-keyword">function</span>() {
      <span class="cm-variable-2">succeed</span>(<span class="cm-variable-2">reader</span>.<span class="cm-property">result</span>);
    });
    <span class="cm-variable-2">reader</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">"error"</span>, <span class="cm-keyword">function</span>() {
      <span class="cm-variable-2">fail</span>(<span class="cm-variable-2">reader</span>.<span class="cm-property">error</span>);
    });
    <span class="cm-variable-2">reader</span>.<span class="cm-property">readAsText</span>(<span class="cm-variable-2">file</span>);
  });
}</pre>
<p><a class="p_ident" id="p_IGRea9SXwb" href="./18_forms.html#p_IGRea9SXwb"></a>Възможно е да се чете само част от файл чрез извикване на <code>slice</code> метода върху него и подаване на <em>result</em> (така наречения <em>blob</em> обект) към reader.</p>
<h2><a class="h_ident" id="h_xMhbz7W4BY" href="./18_forms.html#h_xMhbz7W4BY"></a>Съхраняване  на  данни  от  страна  на  клиента</h2>
<p><a class="p_ident" id="p_JABB1DfeON" href="./18_forms.html#p_JABB1DfeON"></a>Прости HTML страници с малко JavaScript могат да бъдат голяма среда за “мини приложения”. Малки помощни програми, които автоматизират ежедневни неща. Чрез свързване на няколко полета на формуляр с манипулатори на събития, можем да направим нещо от конвертиране на градуси от Целзий и Фаренхайт до изчисляване на пароли от главната парола и името на уеб сайт.</p>
<p><a class="p_ident" id="p_jnKM+3wefQ" href="./18_forms.html#p_jnKM+3wefQ"></a>Когато такова приложение трябва да си спомни нещо между сесиите, можем да използваме JavaScript променливи преди те да се изхвърлят всеки път, когато страницата е затворена. Можем да настроим сървъра, като го свържем с Интернет и нашето приложение да складира нещо там. Ще видим как се прави това в <a href="./20_node.html#node">Глава 20</a>. Но това добавя много допълнителна работа и сложност. Понякога е достатъчно просто да съхраняваме данните в браузъра. Но как?</p>
<p><a class="p_ident" id="p_Coj/4Qj2Wo" href="./18_forms.html#p_Coj/4Qj2Wo"></a>Можем да съхраняваме <em>string</em> данни по начин, който оцелява при презареждане на страницата, като я поставим в <code>localStorage</code> обекта. Този обект ни позволява да подадем <em>string</em> стойности по имена (също като <em>strings</em>), както в този пример: </p>
<pre data-language="javascript" class="snippet cm-s-default"><a class="c_ident" id="c_o4vSpqCBWE" href="./18_forms.html#c_o4vSpqCBWE"></a><span class="cm-variable">localStorage</span>.<span class="cm-property">setItem</span>(<span class="cm-string">"username"</span>, <span class="cm-string">"marijn"</span>);
<span class="cm-variable">console</span>.<span class="cm-property">log</span>(<span class="cm-variable">localStorage</span>.<span class="cm-property">getItem</span>(<span class="cm-string">"username"</span>));
<span class="cm-comment">// → marijn</span>
<span class="cm-variable">localStorage</span>.<span class="cm-property">removeItem</span>(<span class="cm-string">"username"</span>);</pre>
<p><a class="p_ident" id="p_6Jr54na1O5" href="./18_forms.html#p_6Jr54na1O5"></a>Стойности в <code>localStorage</code> остават докато не се променят, те се отстраняват с <code>removeItem</code> или когато потребителя изчисти своите локални данни.</p>
<p><a class="p_ident" id="p_QTrhARZTb/" href="./18_forms.html#p_QTrhARZTb/"></a>Сайтове от различни домейни получават различни отделения за съхранение. Това означава, че данните съхранявани в <code>localStorage</code> от даден уеб сайт могат по принцип да се четат (или презаписват) само чрез скриптове на същия този сайт.</p>
<p><a class="p_ident" id="p_s4JKCuTdO4" href="./18_forms.html#p_s4JKCuTdO4"></a>Браузърите също налагат ограничения за размера на данните на сайта, които могат да се съхраняват в <code>localStorage</code> обикновено от порядъка на няколко мегабайта. Това ограничение заедно с факта, че запълването на твърдите дискове на хората с боклуци не е изгодно, предотвратява тази функция от изяждане на твърде много място.</p>
<p><a class="p_ident" id="p_YJCl32s1ep" href="./18_forms.html#p_YJCl32s1ep"></a>Следващия код реализира приложение за просто водене на бележки. То запазва бележките на потребителя, като обект, асоциирайки заглавията със <em>string</em>-овото съдържание. Тази задача се кодира, като JSON и се съхранява в  <code>localStorage</code>. Потребителя може да избере една бележка от <code>&lt;select&gt;</code> полето и промени текста на бележката в една <code>&lt;textarea&gt;</code>. Бележката може да се добави и с натискане на бутон.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_KWMxwv14ip" href="./18_forms.html#c_KWMxwv14ip"></a>Notes: <span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">select</span> <span class="cm-attribute">id</span>=<span class="cm-string">"list"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">select</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">onclick</span>=<span class="cm-string">"addNote()"</span><span class="cm-tag cm-bracket">&gt;</span>new<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;&lt;</span><span class="cm-tag">br</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">textarea</span> <span class="cm-attribute">id</span>=<span class="cm-string">"currentnote"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"width: 100%; height: 10em"</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">textarea</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-keyword">var</span> <span class="cm-variable">list</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"#list"</span>);
  <span class="cm-keyword">function</span> <span class="cm-variable">addToList</span>(<span class="cm-def">name</span>) {
    <span class="cm-keyword">var</span> <span class="cm-def">option</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">createElement</span>(<span class="cm-string">"option"</span>);
    <span class="cm-variable-2">option</span>.<span class="cm-property">textContent</span> <span class="cm-operator">=</span> <span class="cm-variable-2">name</span>;
    <span class="cm-variable">list</span>.<span class="cm-property">appendChild</span>(<span class="cm-variable-2">option</span>);
  }

  <span class="cm-comment">// Initialize the list from localStorage</span>
  <span class="cm-keyword">var</span> <span class="cm-variable">notes</span> <span class="cm-operator">=</span> <span class="cm-variable">JSON</span>.<span class="cm-property">parse</span>(<span class="cm-variable">localStorage</span>.<span class="cm-property">getItem</span>(<span class="cm-string">"notes"</span>)) <span class="cm-operator">||</span>
              {<span class="cm-string cm-property">"shopping list"</span>: <span class="cm-string">""</span>};
  <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-variable">name</span> <span class="cm-keyword">in</span> <span class="cm-variable">notes</span>)
    <span class="cm-keyword">if</span> (<span class="cm-variable">notes</span>.<span class="cm-property">hasOwnProperty</span>(<span class="cm-variable">name</span>))
      <span class="cm-variable">addToList</span>(<span class="cm-variable">name</span>);

  <span class="cm-keyword">function</span> <span class="cm-variable">saveToStorage</span>() {
    <span class="cm-variable">localStorage</span>.<span class="cm-property">setItem</span>(<span class="cm-string">"notes"</span>, <span class="cm-variable">JSON</span>.<span class="cm-property">stringify</span>(<span class="cm-variable">notes</span>));
  }

  <span class="cm-keyword">var</span> <span class="cm-variable">current</span> <span class="cm-operator">=</span> <span class="cm-variable">document</span>.<span class="cm-property">querySelector</span>(<span class="cm-string">"#currentnote"</span>);
  <span class="cm-variable">current</span>.<span class="cm-property">value</span> <span class="cm-operator">=</span> <span class="cm-variable">notes</span>[<span class="cm-variable">list</span>.<span class="cm-property">value</span>];

  <span class="cm-variable">list</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">"change"</span>, <span class="cm-keyword">function</span>() {
    <span class="cm-variable">current</span>.<span class="cm-property">value</span> <span class="cm-operator">=</span> <span class="cm-variable">notes</span>[<span class="cm-variable">list</span>.<span class="cm-property">value</span>];
  });
  <span class="cm-variable">current</span>.<span class="cm-property">addEventListener</span>(<span class="cm-string">"change"</span>, <span class="cm-keyword">function</span>() {
    <span class="cm-variable">notes</span>[<span class="cm-variable">list</span>.<span class="cm-property">value</span>] <span class="cm-operator">=</span> <span class="cm-variable">current</span>.<span class="cm-property">value</span>;
    <span class="cm-variable">saveToStorage</span>();
  });

  <span class="cm-keyword">function</span> <span class="cm-variable">addNote</span>() {
    <span class="cm-keyword">var</span> <span class="cm-def">name</span> <span class="cm-operator">=</span> <span class="cm-variable">prompt</span>(<span class="cm-string">"Note name"</span>, <span class="cm-string">""</span>);
    <span class="cm-keyword">if</span> (<span class="cm-operator">!</span><span class="cm-variable-2">name</span>) <span class="cm-keyword">return</span>;
    <span class="cm-keyword">if</span> (<span class="cm-operator">!</span><span class="cm-variable">notes</span>.<span class="cm-property">hasOwnProperty</span>(<span class="cm-variable-2">name</span>)) {
      <span class="cm-variable">notes</span>[<span class="cm-variable-2">name</span>] <span class="cm-operator">=</span> <span class="cm-string">""</span>;
      <span class="cm-variable">addToList</span>(<span class="cm-variable-2">name</span>);
      <span class="cm-variable">saveToStorage</span>();
    }
    <span class="cm-variable">list</span>.<span class="cm-property">value</span> <span class="cm-operator">=</span> <span class="cm-variable-2">name</span>;
    <span class="cm-variable">current</span>.<span class="cm-property">value</span> <span class="cm-operator">=</span> <span class="cm-variable">notes</span>[<span class="cm-variable-2">name</span>];
  }
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<p><a class="p_ident" id="p_IXFtJG2tv8" href="./18_forms.html#p_IXFtJG2tv8"></a>Скрипта инициализира <code>notes</code> променлива към стойността съхранявана в <code>localStorage</code> или ако липсва такава, само прост обект с празен <code>"shopping list"</code> бележка в него. Четене на поле, което не съществува в <code>localStorage</code> ще получи <code>null</code>. Подавайки <code>null</code> към <code>JSON.parse</code>, той ще направи разбор на <em>string</em> <code>"null"</code> и ще върне <code>null</code>. По този начин <code>||</code> оператора може да се използва за предоставяне на стойност по подразбиране в ситуация, като тази.</p>
<p><a class="p_ident" id="p_JoUCwxZ7ZG" href="./18_forms.html#p_JoUCwxZ7ZG"></a>Всеки път, когато се променят данните в бележката (когато се добавя нова бележка или се променя старата), се извиква функцията <code>saveToStorage</code> за да актуализира полето за съхранение. Ако това приложение е предназначено да обработва хиляди бележки, а не само няколко, това би било твърде скъпо и трябва да излезем с по-сложен начин за съхраняването им, като даде на всяка бележка собствено поле за съхранение.</p>
<p><a class="p_ident" id="p_jDISw6dQzZ" href="./18_forms.html#p_jDISw6dQzZ"></a>Когато потребителя добави нова бележка, кодът трябва да  актуализира текстовото поле изрично, въпреки че <code>&lt;select&gt;</code> полето има <code>"change"</code> манипулатор, който прави същото нещо. Това е необходимо, тъй като ефекта на <code>"change"</code> събитията се появява само, когато потребителя промени стойността на полето, а не когато скрипта го прави.</p>
<p><a class="p_ident" id="p_McB+3/vKwy" href="./18_forms.html#p_McB+3/vKwy"></a>Има и друг обект подобен на <code>localStorage</code> , наречен <code>sessionStorage</code>. Разликата между двата е, че съдържанието на <code>sessionStorage</code> се забравя в края на всяка сесия, което за повечето браузъри означава, когато браузъра се затваря.</p>
<h2><a class="h_ident" id="h_ErccPg/l98" href="./18_forms.html#h_ErccPg/l98"></a>Резюме</h2>
<p><a class="p_ident" id="p_ZKWYUfmZEa" href="./18_forms.html#p_ZKWYUfmZEa"></a>HTML може да изразява различни видове полета на формите, като например, текстови полета, полета с отметки, множествен избор на полета и файлови колектори.</p>
<p><a class="p_ident" id="p_1zn4gfsnbO" href="./18_forms.html#p_1zn4gfsnbO"></a>Такива полета могат да бъдат инспектирани и манипулирани с JavaScript. Те ползват ефекта на <code>"change"</code> събитие за да го променят, на <code>"input"</code> събитие, когато текста е написан, както и различни видове клавишни събития. Тези събития ни позволяват да забележим, когато потребителя взаимодейства с полетата. Информация, като <code>value</code> (за текст или избор на поле) или <code>checked</code> (за чек-бокс и радио бутони) се използват за прочитане или задаване на съдържанието на полето.</p>
<p><a class="p_ident" id="p_ga1YeRsvqD" href="./18_forms.html#p_ga1YeRsvqD"></a>Когато се представя форма се използва ефекта на нейното <code>"submit"</code> събитие. Ако JavaScript манипулатора извика <code>preventDefault</code> върху такова събитие се предотвратява подаването да се случи. Елементите на полетата на формите не трябва да бъдат опаковани във <code>&lt;form&gt;</code> тагове.</p>
<p><a class="p_ident" id="p_4GN43j/R8o" href="./18_forms.html#p_4GN43j/R8o"></a>Когато потребителя е избрал файл от тяхната локална файлова система в колекторното поле на файла, интерфейса на <code>FileReader</code> може да се използва за достъп до съдържанието на този файл от програма на JavaScript.</p>
<p><a class="p_ident" id="p_KjH+jrxywQ" href="./18_forms.html#p_KjH+jrxywQ"></a>Обектите <code>localStorage</code> и <code>sessionStorage</code> могат да се използват за запазване на информация по начин, който оцелява при презареждане на страниците. Първият запазва данните за винаги (или докато потребителя не реши да ги изчисти), а втория ги запазва до затваряне на браузъра.</p>
<h2><a class="h_ident" id="h_TcUD2vzyMe" href="./18_forms.html#h_TcUD2vzyMe"></a>Упражнения</h2>
<h3><a class="h_ident" id="h_wTXvIH5Wds" href="./18_forms.html#h_wTXvIH5Wds"></a>Работна маса на JavaScript</h3>
<p><a class="p_ident" id="p_EyD8Y/DOXP" href="./18_forms.html#p_EyD8Y/DOXP"></a>Изградете интерфейс, който позволява на хората да работят и пускат парчета JavaScript код.</p>
<p><a class="p_ident" id="p_eGmPVJLy/G" href="./18_forms.html#p_eGmPVJLy/G"></a>Сложете един бутон в близост до полето на <code>&lt;textarea&gt;</code>, който когато бъде натиснат, използва  <code>Function</code> конструктора, който видяхме в <a href="./10_modules.html#eval">Глава 10</a> за увиване на текста във функция и го извиква. Конвертирайте крайния резултат от изпълнението на функцията или грешката, която се повдига в <em>string</em>, който да се покаже след текстовото поле.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_VLd5vS1u8A" href="./18_forms.html#c_VLd5vS1u8A"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">textarea</span> <span class="cm-attribute">id</span>=<span class="cm-string">"code"</span><span class="cm-tag cm-bracket">&gt;</span>return "hi";<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">textarea</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">id</span>=<span class="cm-string">"button"</span><span class="cm-tag cm-bracket">&gt;</span>Run<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">pre</span> <span class="cm-attribute">id</span>=<span class="cm-string">"output"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">pre</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-comment">// Your code here.</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<div class="solution"><div class="solution-text">
<p><a class="p_ident" id="p_UvZ1ElIw3/" href="./18_forms.html#p_UvZ1ElIw3/"></a>Използвайте <code>document.querySelector</code>
или <code>document.getElementById</code> да получите достъп до елементите, определени в HTML. С един манипулатор на събитие за <code>"click"</code> или <code>"mousedown"</code> на бутона може да получите  <code>value</code> свойството на текстовото поле и да извикате <code>new Function</code> върху него.</p>
<p><a class="p_ident" id="p_uLWfzgaSrI" href="./18_forms.html#p_uLWfzgaSrI"></a>Уверете се, че сте увили  повикването към  <code>new Function</code> и повиквнето към резултата в <code>try</code> блока, така че да можете да хванете изключенията, които той произвежда. В този случай ние наистина не знаем какъв тип изключение търсим, така че трябва да хваща всичко.</p>
<p><a class="p_ident" id="p_TWN0owIpP4" href="./18_forms.html#p_TWN0owIpP4"></a>Свойството <code>textContent</code> на изходния елемент може да се използва за да се напълни със string съобщение. Или ако искате да запазите старото съдържание, създайте ново текстово разклонение, като използвате <code>document.createTextNode</code> и го добавете към елемента. Не забравяйте да добавите символ за нов ред в края, така че всичко на изхода да не се появява на един ред.</p>
</div></div>
<h3><a class="h_ident" id="h_pGljYPYc57" href="./18_forms.html#h_pGljYPYc57"></a>Автоматично довършване</h3>
<p><a class="p_ident" id="p_xkMXec3dUE" href="./18_forms.html#p_xkMXec3dUE"></a>Разширете текстовото поле, така че когато потребителя пише, да се покаже списък с предложени стойности, който да се покаже по-долу на полето. Имате набор от възможни стойности на разположение, като трябва да се покажат тези, с които започва текста, който е написан. Когато едно предложение се натисне, то да замени сегашната стойност в текста на полето.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_PuMC7wrWAj" href="./18_forms.html#c_PuMC7wrWAj"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">input</span> <span class="cm-attribute">type</span>=<span class="cm-string">"text"</span> <span class="cm-attribute">id</span>=<span class="cm-string">"field"</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">id</span>=<span class="cm-string">"suggestions"</span> <span class="cm-attribute">style</span>=<span class="cm-string">"cursor: pointer"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-comment">// Builds up an array with global variable names, like</span>
  <span class="cm-comment">// 'alert', 'document', and 'scrollTo'</span>
  <span class="cm-keyword">var</span> <span class="cm-variable">terms</span> <span class="cm-operator">=</span> [];
  <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-variable">name</span> <span class="cm-keyword">in</span> <span class="cm-variable">window</span>)
    <span class="cm-variable">terms</span>.<span class="cm-property">push</span>(<span class="cm-variable">name</span>);

  <span class="cm-comment">// Your code here.</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<div class="solution"><div class="solution-text">
<p><a class="p_ident" id="p_Z5ghBcgWqZ" href="./18_forms.html#p_Z5ghBcgWqZ"></a>Най-добрия случай за актуализиране на списъка с предложения е <code>"input"</code>, тъй като това ще се изстреля незабавно при промяна на съдържанието в полето.</p>
<p><a class="p_ident" id="p_2CLauByVZn" href="./18_forms.html#p_2CLauByVZn"></a>После с цикъл над масива от изрази за да видите дали е започнат с даден <em>string</em>. Например, може да извикате <code>indexOf</code> и да видите дали резултата е нулев. За всяко съвпадение на <em>string</em> добавяте елемент към предложенията <code>&lt;div&gt;</code>. Вероятно също и за празни, така че всеки път, когато стартирате актуализирането на предложенията, например, като му зададете <code>textContent</code> за празен <em>string</em>.</p>
<p><a class="p_ident" id="p_5rUQoI8gua" href="./18_forms.html#p_5rUQoI8gua"></a>Можете също да добавите манипулатор за <code>"click"</code> събитие на всеки елемент предложение или да добавите един на външния <code>&lt;div&gt;</code> който ги притежава и погледнете с <code>target</code> свойството на събитието, за да разберете кое предложение е било кликнато.</p>
<p><a class="p_ident" id="p_JhSLvfJ/T9" href="./18_forms.html#p_JhSLvfJ/T9"></a>За да получите текста с предложението от едно DOM разклонение, можете да погледнете неговия <code>textContent</code> или определите атрибут за изрично съхраняване на текст, когато създавате елемента.</p>
</div></div>
<h3><a class="h_ident" id="h_wZdunPqDkM" href="./18_forms.html#h_wZdunPqDkM"></a>Игра- Живота на Конуей</h3>
<p><a class="p_ident" id="p_Jvg4FGRdgU" href="./18_forms.html#p_Jvg4FGRdgU"></a>Играта живота на Конуей е проста симулация, която създава изкуствен живот в една мрежа от клетки, всяка от тези клетки е жива или не. На всяко поколение (което включите) се прилагат следните правила:</p>
<div class="ulist"><ul>
<li>
<p><a class="p_ident" id="p_H6UexnLxhi" href="./18_forms.html#p_H6UexnLxhi"></a>
Всяка от живите клетки с по-малко от две или повече от три живи съседни клетки умира.
</p>
</li>
<li>
<p><a class="p_ident" id="p_jSyY/y/HMp" href="./18_forms.html#p_jSyY/y/HMp"></a>
Всяка жива клетка с две или три живи съседни клетки, дава живот на следващо поколение.
</p>
</li>
<li>
<p><a class="p_ident" id="p_y/DnAd+/CJ" href="./18_forms.html#p_y/DnAd+/CJ"></a>
Всяка от мъртвите клетки с точно три живи съседни клетки се превръща в жива клетка.
</p>
</li>
</ul></div>
<p><a class="p_ident" id="p_iKiryFZsbT" href="./18_forms.html#p_iKiryFZsbT"></a>Един съсед се определя от всяка прилежаща съседна клетка включително и прилежащите по диагонал.</p>
<p><a class="p_ident" id="p_9dLS2RK5SZ" href="./18_forms.html#p_9dLS2RK5SZ"></a>Имайте в предвид, че тези правила се прилагат за цялата мрежа наведнъж, а не на даден квадрат в определен момент. Това означава, че преброяването на съседите се основава на ситуацията в началото на поколението, както и промените, които се случват на съседните клетки по време на това поколение не трябва да влияят на новото състояние на дадена клетка.</p>
<p><a class="p_ident" id="p_W0m8oVpi7M" href="./18_forms.html#p_W0m8oVpi7M"></a>Прилагането на тази игра, с помощта на което може да се намери структура от данни е поучаващо. Използвайте <code>Math.random</code> за населване на мрежата с произволен модел първоначално. Покажете я като решетка от полета с отметки (чек-бокс) с един бутон до нея за да преминете към следващото поколение. Когато потребителя маркира или не маркира квадратчета , техните промени трябва да бъдат включени, когато се изчислява новото поколение.</p>
<pre data-language="text/html" class="snippet cm-s-default"><a class="c_ident" id="c_8a3OdQKUdc" href="./18_forms.html#c_8a3OdQKUdc"></a><span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">div</span> <span class="cm-attribute">id</span>=<span class="cm-string">"grid"</span><span class="cm-tag cm-bracket">&gt;&lt;/</span><span class="cm-tag">div</span><span class="cm-tag cm-bracket">&gt;</span>
<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">button</span> <span class="cm-attribute">id</span>=<span class="cm-string">"next"</span><span class="cm-tag cm-bracket">&gt;</span>Next generation<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">button</span><span class="cm-tag cm-bracket">&gt;</span>

<span class="cm-tag cm-bracket">&lt;</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span>
  <span class="cm-comment">// Your code here.</span>
<span class="cm-tag cm-bracket">&lt;/</span><span class="cm-tag">script</span><span class="cm-tag cm-bracket">&gt;</span></pre>
<div class="solution"><div class="solution-text">
<p><a class="p_ident" id="p_Aww6OjjuYz" href="./18_forms.html#p_Aww6OjjuYz"></a>За да се реши проблема с промените концептуално случващи се по същото време, опитайте да видите изчисляването на едно поколение, като чиста функция, която отнема една клетка и произвежда нова клетка, която представя на следващото завъртане.</p>
<p><a class="p_ident" id="p_xuG6OwlRd8" href="./18_forms.html#p_xuG6OwlRd8"></a>Представяне на мрежата може да се направи с всеки от начините показани в Глави <a href="./07_elife.html#grid">7</a> и <a href="./15_game.html#level">15</a>. Преброяване на живите съседи може да се направи с два вложени цикъла, минаващи над съседни координати. Внимавайте да не брои клетки извън терена и да не обръща внимание на клетки в центъра, чиито съседи ние броим.</p>
<p><a class="p_ident" id="p_KHncyuOOIQ" href="./18_forms.html#p_KHncyuOOIQ"></a>Извършените промени в <em>checkboxes</em> влизат в сила при следващото поколение и могат да се направят по два начина. Един манипулатор на събитие би могъл да забележи тези промени и да обнови текуща та мрежа за да ги отрази или може да генерираме нова мрежа от стойностите в квадратчетата преди изчисляване на следващото завъртане.</p>
<p><a class="p_ident" id="p_wu3Ty9I4d4" href="./18_forms.html#p_wu3Ty9I4d4"></a>Ако изберете манипулатори, трябва да прикачите атрибути, които определят позицията, на която отговаря всяко квадратче, така че лесно да разберете кои клетки се променят.</p>
<p><a class="p_ident" id="p_XFp+gOIONt" href="./18_forms.html#p_XFp+gOIONt"></a>За да направите мрежа от отметки, можете да използвате <code>&lt;table&gt;</code> елемент (виж <a href="./13_dom.html#exercise_table">Глава 13</a>) или просто да ги поставите в един и същ елемент, като сложите елемента <code>&lt;br&gt;</code> (нов ред) между редовете.</p>
</div></div>
<nav>
  <a href="./17_http.html" title="previous chapter">◀</a>
  <a href="./index.html" title="cover">◆</a>
  <a href="./19_paint.html" title="next chapter">▶</a>
</nav>
</article>
</body></html>